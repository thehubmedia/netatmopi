{% extends "plugin.html" %}

{% block content %}
<div class="weather-dashboard">
    <!-- Header with Station Info -->
    <div class="header">
        <div class="station-name">{{ station.name }}</div>
        <div class="station-info">Station {{ station.index }} of {{ station.total }} ‚Ä¢ Updated {{ updated }}</div>
    </div>

    {% if netatmo.available %}
    <!-- Current Weather (Netatmo Real-Time) -->
    <div class="current-weather">
        <div class="current-main">
            <div class="current-temp-section">
                {% if owm.current %}
                <div class="condition-icon">
                    {% if '01' in owm.current.icon %}<img src="{{ icons['clear-day.svg'] }}" alt="Clear">
                    {% elif '02' in owm.current.icon %}<img src="{{ icons['partly-cloudy.svg'] }}" alt="Partly Cloudy">
                    {% elif '03' in owm.current.icon or '04' in owm.current.icon %}<img src="{{ icons['cloudy.svg'] }}" alt="Cloudy">
                    {% elif '09' in owm.current.icon or '10' in owm.current.icon %}<img src="{{ icons['rain.svg'] }}" alt="Rain">
                    {% elif '11' in owm.current.icon %}<img src="{{ icons['thunderstorm.svg'] }}" alt="Thunderstorm">
                    {% elif '13' in owm.current.icon %}<img src="{{ icons['snow.svg'] }}" alt="Snow">
                    {% elif '50' in owm.current.icon %}<img src="{{ icons['fog.svg'] }}" alt="Fog">
                    {% else %}<img src="{{ icons['thermometer.svg'] }}" alt="Weather">
                    {% endif %}
                </div>
                {% endif %}
                <div class="current-temp-group">
                    <div class="current-temp">{{ netatmo.outdoor_temp }}</div>
                    {% if owm.current %}
                    <div class="condition-text">{{ owm.current.description }}</div>
                    {% endif %}
                </div>
            </div>
            <div class="current-details">
                <div class="detail-item">üíß {{ netatmo.outdoor_humidity }}</div>
                <div class="detail-item">üéöÔ∏è {{ netatmo.pressure }}</div>
                {% if netatmo.wind_speed %}
                <div class="detail-item">üí® {{ netatmo.wind_speed }}</div>
                {% endif %}
            </div>
            <div class="current-rain">
                {% if netatmo.rain_24h is not none %}
                <div class="rain-row">
                    <div class="rain-label">Actual</div>
                    <div class="rain-value">{{ netatmo.rain_24h }}</div>
                </div>
                {% endif %}
                {% if owm.today_rain_forecast %}
                <div class="rain-row">
                    <div class="rain-label">Forecast</div>
                    <div class="rain-value">{{ owm.today_rain_forecast.amount }} ({{ owm.today_rain_forecast.chance }})</div>
                </div>
                {% endif %}
            </div>
        </div>

        {% if netatmo.indoor_temp %}
        <div class="indoor-badge">
            üè† Indoor: {{ netatmo.indoor_temp }} ‚Ä¢ üíß {{ netatmo.indoor_humidity }}{% if netatmo.co2 %} ‚Ä¢ üí® {{ netatmo.co2 }}{% endif %}{% if netatmo.noise %} ‚Ä¢ üîä {{ netatmo.noise }}{% endif %}
        </div>
        {% endif %}
    </div>
    {% else %}
    <div class="no-data">Netatmo data unavailable</div>
    {% endif %}

    {% if owm.available %}
    <!-- Combined Forecast Section -->
    <div class="forecast-section">
        <div class="section-title">Next 12 Hours / {{ owm.daily|length }}-Day Forecast</div>
        <div class="hourly-grid">
            {% for hour in owm.hourly[:12] %}
            <div class="hour-card">
                <div class="hour-time">{{ hour.time }}</div>
                <div class="hour-icon">
                    {% if '01' in hour.icon %}<img src="{{ icons['clear-day.svg'] }}" alt="Clear">
                    {% elif '02' in hour.icon %}<img src="{{ icons['partly-cloudy.svg'] }}" alt="Partly Cloudy">
                    {% elif '03' in hour.icon or '04' in hour.icon %}<img src="{{ icons['cloudy.svg'] }}" alt="Cloudy">
                    {% elif '09' in hour.icon or '10' in hour.icon %}<img src="{{ icons['rain.svg'] }}" alt="Rain">
                    {% elif '11' in hour.icon %}<img src="{{ icons['thunderstorm.svg'] }}" alt="Thunderstorm">
                    {% elif '13' in hour.icon %}<img src="{{ icons['snow.svg'] }}" alt="Snow">
                    {% elif '50' in hour.icon %}<img src="{{ icons['fog.svg'] }}" alt="Fog">
                    {% else %}<img src="{{ icons['thermometer.svg'] }}" alt="Weather">
                    {% endif %}
                </div>
                <div class="hour-temp">{{ hour.temp }}¬∞</div>
                {% if hour['pop'] > 20 %}
                <div class="hour-pop">{{ hour['pop'] }}%</div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        <div class="daily-grid">
            {% for day in owm.daily %}
            <div class="day-card">
                <div class="day-name">{{ day.day }}</div>
                <div class="day-icon">
                    {% if '01' in day.icon %}<img src="{{ icons['clear-day.svg'] }}" alt="Clear">
                    {% elif '02' in day.icon %}<img src="{{ icons['partly-cloudy.svg'] }}" alt="Partly Cloudy">
                    {% elif '03' in day.icon or '04' in day.icon %}<img src="{{ icons['cloudy.svg'] }}" alt="Cloudy">
                    {% elif '09' in day.icon or '10' in day.icon %}<img src="{{ icons['rain.svg'] }}" alt="Rain">
                    {% elif '11' in day.icon %}<img src="{{ icons['thunderstorm.svg'] }}" alt="Thunderstorm">
                    {% elif '13' in day.icon %}<img src="{{ icons['snow.svg'] }}" alt="Snow">
                    {% elif '50' in day.icon %}<img src="{{ icons['fog.svg'] }}" alt="Fog">
                    {% else %}<img src="{{ icons['thermometer.svg'] }}" alt="Weather">
                    {% endif %}
                </div>
                <div class="day-temps">
                    <span class="temp-high">{{ day.high }}¬∞</span>
                    <span class="temp-divider">/</span>
                    <span class="temp-low">{{ day.low }}¬∞</span>
                </div>
                {% if day['pop'] > 20 %}
                <div class="day-pop">{{ day['pop'] }}%</div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <div class="no-data">Forecast data unavailable</div>
    {% endif %}
</div>
{% endblock %}
